## 问题出现的根源

1. 传统 UI 操作关注太多细节才能更新页面上的 UI。

2. 应用程序状态分散在各处，难以追踪和维护。

## React 提出的解决方案

用一个聊天应用的示例来说明，这个聊天应用需要将新消息到达时展示在页面上。

首先是传统 web 开发的局部更新。我们需要知道来的消息中，哪条是新的消息。然后针对新消息创建一个 DOM 节点，并且把这个节点更新到 UI 上。

**React 的思路：始终是整体刷新，无需关心细节。**前后是两个状态，一个是两条消息，一个是三条消息。它并不关注哪条消息是新的。它的逻辑是把整个消息展示在 UI 上。

React 并不关心细节，当 React 发现前后两个状态变了，相应的 UI 也会变化，React 自动完成 UI 更新的操作。

这样就把我们从细节操作的复杂度中解放出来，我们只需要关心状态及最终 UI 长什么样。

对比传统的 web 开发，React 的特点如下：

1. 1 个新概念

2. 4 个必须 API

3. 单向数据流

4. 完善的错误提示

React 解决了 UI 细节问题。

数据模型的解决依赖 Flux 结构。

传统 MVC 难以扩展和维护

它有非常多的 model，非常多的 view，这些 model 和 view 之间的使用关心是错综复杂的，而且是双向绑定的。
这导致的问题就是：当应用程序复杂了以后，出现了一个问题，很难去追踪究竟是 model 出现了问题，还是 view 出现了问题。

React 提出了 Flux 架构：单向数据流

Flux 架构并不是一个完整的技术实现，而是一种设计模式，它的核心思想就是单向数据流。一个完整的 Flux 架构流程就是:当 React Views 发生了一些用户操作，它会产生一个 action,这个 action 会通过 dispatcher 来 dispatch 出去，由 store 来进行处理，store 根据 action 来更新自己。我们的 view 是绑定在 store 上的，所以 store 发生变化，view 也会更新。

## 以组件方式考虑构建 UI

React 中最核心的概念就是组件 component。组件可以让我们更直观地去描述我们的界面。通过这种方式可以很好很直观的描述我们的 UI，而且很自然的把 UI 拆分成比较小的独立的部分。

## 理解 React 组件

1. React 组件一般不提供方法，而是某种状态机
2. React 组件可以理解为一个纯函数
3. 单向数据绑定

由属性 (props) 和状态 (state) 最终得到一个 View。

React 组件的状态 (state) 由两种。一种是由外部传进来的属性 (props)，一种是内部维持的状态 (state)。
二者共同决定了 View 长什么样。

所以一个 React 组件可以理解为一个纯函数一样，它接受的参数是什么，输出的结果一定是确定的。
React 组件一般不会提供方法。

单向数据流：外部要传数据进来，一定是通过 props 传进来。

如果组件外部要知道 View 内部发生了什么变化，那一定是 View 内部暴露了一个事件来让组件外部知道我们的组件内部发生了变化。

## React 组件的两种类型：受控组件和非受控组件

1. 受控组件

受控组件 Controlled Components 必须传递两个值，一个 value，一个 onChange。

它的值是什么取决于外部给它的属性而不是用户的输入，如果不指定 onChange 事件，输入任何值 value 都不会有变化。它的状态来自外部

2. 非受控组件

Uncontrolled Components 非受控组件 它的状态由内部维护。

外部要用的时候是通过其它方式拿到它的值，这样的组件不需要传递 value 和 onChange 事件，但是一定要让外界知道这个原生 DOM node 是什么，从而才能够拿到它的值。

## 何时创建组件：单一职责原则

1. 每个组件只做一件事

2. 如果组件变得复杂，那么应该拆分成小组件
   组件是构建 UI 的最小的元素，每个组件都应该尽量地小，这样才能使复杂度分散出去。

拆分小组件有两个好处

第一可以让复杂度拆分到不同的地方，

第二是性能问题：当一个组件很大时，任何一个状态变化，整个组件都会进行刷新。如果拆分成小组件，这些小组件的状态可能没有变化，那它就不需要重新刷新，这样的化可以提高性能。

## 数据状态管理:DRY 原则

1. 能计算得到的状态就不要单独存储：能计算得到的状态在用的时候去计算它，而不是单独存储起来。

2. 组件尽量无状态，所需数据通过 props 获取：组件尽量无状态的好处是，可以让组件尽量是一个纯组件，他可以具有更好的性能，并且可以更容易被重用。

## 理解 JSX: 不是模板语言，只是一种语法糖

JSX:在 JavaScript 代码中直接写 HTML 标记

JSX 的本质：动态创建组件的语法糖

## 对比其它模板语言 JSX 优点

1. 声明式创建界面的直观
2. 代码动态创建界面的灵活
3. 无需学习新的模板语言

## 约定：自定义组件以大写字母开头

1. React 认为小写的 tag 是原生 DOM 节点，如 div

2. 大写字母开头为自定义组件

3. JSX 标记可以直接使用属性语法，例如<menu.Item />

[纯 React 技术目录](https://github.com/EthanLin-TWer/linesh-simplicity.github.io/issues/122)

[Frontend-react](https://github.com/peterlxb/Frontend-react/issues?page=4&q=is%3Aissue+is%3Aopen)
