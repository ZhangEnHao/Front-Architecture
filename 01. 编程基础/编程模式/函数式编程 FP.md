## 函数式编程

把现实世界的事物和事物之间的联系抽象到程序世界（对运算过程抽象）。

- 程序的本质：根据输入通过某种运算获得相应的输出，程序开发过程中会涉及很多有输入和输出的函数。
- 描述数据之间的映射：x -> f(联系、映射) -> y === y = f(x).
- 函数式编程中的函数不是指程序中的方法，而是数学中的映射。
- 相同的输入始终要得出相同的输出（纯函数）。
- 函数式编程用来描述数据（函数）之间的映射。
- 更换思维方式：用表达式（映射）来描述程序（而非用过程组织计算）
- 实现最小粒度的函数封装、组合、复用（积木逻辑）

## 函数是一等公民

在 MDN 中用以下三点作为「函数是一等公民」的解释：

- 函数可以存储在变量中
- 函数可以作为参数
- 函数可以作为返回值

在 JavaScript 中函数就是一个普通的对象 （可以通过 new Function()的方式来创建一个函数对象 )，因为函数是一个普通的对象，所以可以把函数存储到变量或者数组中 -> 因为函数是对象，所以可以像对象一样把它作为另一个函数的参数或者是函数的返回值，甚至还可以在程序运行的时候通过 new Function('alert(1)') 的方式来构造一个新的函数。

## 高阶函数 「Higher-Order Function」

1. 概念

- 函数作为参数传递给另一个函数 -> 这个函数参数被称为「Callback function」。eg: 数组的各种迭代方法
- 函数作为另一个函数的返回值 -> 这是函数是一等公民的特性。eg: Lodash.once

只要满足其中之一，那么这「另一个函数」就是一个高阶函数。

2. 意义

高阶函数中，把函数作为参数的一个好处：

- 让函数变得很灵活，如 `forEach` 和 `filter` -> `callback` 的不同，可以实现不同的效果。
- 抽象可以屏蔽实现的细节，以后再调用这些函数的时候，只要关注要实现的目标就可以了，而且函数的名字是有实际意义的，如 forEach 由名字可知「它就是要去遍历」，而 filter 就是过滤。

## 闭包

闭包的本质：函数在执行的时候会放到一个执行栈上，正常情况下，当函数执行完毕之后会从执行栈上移除。然而，如果外部对函数内部有引用的话，当外部函数执行完毕后，外部函数内部的成员不会从内存中移除，也就是堆上的作用域成员（inner 函数）因为被外部作用域引用所以函数不能释放，因此内部函数（inner）依然可以访问外部函数中的成员。

## 纯函数

1. 定义

- 函数的返回结果只依赖于它的参数，相同的输入始终得到相同的输出
- 函数的执行过程里面没有副作用

即相同的输入，永远会得到相同的输出，而且没有任何可观察的副作用。

2. 副作用

副作用是在计算结果的过程中，系统状态的一种变化，或者与外部世界进行的可观察的交互。

- “作用”本身并没什么坏处。“副作用”的关键部分在于“副”。就像一潭死水中的“水”本身并不是幼虫的培养器，“死”才是生成虫群的原因。同理，副作用中的“副”是滋生 bug 的温床。
- 只要是跟函数外部环境发生的交互就都是副作用。
- 这并不是说，要禁止使用一切副作用，而是说，要让它们在可控的范围内发生 -> functor 和 monad 可以让我们学习如何控制副作用，总之请尽量远离这些阴险的函数。

3. 优点

- 可缓存：相同的输入，可产生相同的输出

- 可测试

- 并行处理

## 柯里化（curry）

当一个函数有多个参数的时候，可以先传递一部分参数调用它（这部分参数以后永远不会发生变化），并且返回一个新的函数 -> 这个新的函数用来接收剩余的参数，并未返回函数执行的结果。

## 函数组合（compose）

如果一个函数要经过多个函数处理才能得到最终值，这个时候可以把中间过程的函数合并成一个函数，而在处理的过程中，这些中间函数会得到相应的中间结果 -> 这些中间结果，我们不需要关注。

- 函数就像是一个数据的管道，数据通过这些管道会得到相应的结果，而函数组合就是把这些管道连接起来，让数据穿过多个管道最终获得所期望的结果。

- 函数组合默认情况下是从右到左执行。

多个函数组合之后返回了一个新函数。

如果次序不重要，就叫组合。 如果次序重要就叫排列。

函数组合要满足一个特点 —— 结合律。

注意：在函数组合的时候 -> 需要的是一些只有一个参数的纯函数

## Pointfree

Point Free 是一种编程风格，它的具体实现是函数的组合，而它更抽象一些。

> 类似接口与实现

`Pointfree`：可以把数据处理的过程定义成与数据无关的合成运算，而在这个过程中，不需要用到代表数据的那个参数，只需要把简单的运算步骤合成（合并）到一起（这其实就是函数的组合），而在使用这种模式之前需要定义一些辅助的基本运算函数。

- 不需要指明处理的数据

- 只需要合成运算的过程

- 需要定义一些辅助的基本运算函数

之前在使用函数组合去处理问题的时候，其实就是一种 Point Free 模式。

- 定义一些基本的运算函数

- 把小函数合成为一个新的函数 -> 合成过程中，不需要指明我们要处理的数据。

FP 的核心其实就是把运算过程抽象成函数，而 Point Free 模式就是把抽象出来的函数再合成成一个新的函数，而这个合成的过程其实又是一个抽象的过程，在这个抽象的过程中，依然是不用关心数据的。

Pointfree 模式能够减少不必要的命名，让代码保持简洁和通用。

## 函子（Functor）

如果一个容器里面有 `of` 方法，就称为有指向的容器

函数式编程，使用的时候尽可能不要 `new` 对象，写一个类似静态工厂方法的 `of` 方法，用来返回生产想要的实例。

```JavaScript
class PointedContainer {
  constructor(value) {
    this.value = value;
  }

  static of(value) {
    return new PointedContainer(value);
  }
}

let p = PointedContainer.of(1);
```

如果

[函数式编程指北](https://llh911001.gitbooks.io/mostly-adequate-guide-chinese/content/)
